import java.awt.Color;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.PrintWriter;

import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.SwingConstants;


public class ButtonPanel extends JPanel
{
	public ButtonPanel()
	{
		setLayout(new GridLayout(0,3));
		setVisible(true);
		MyButton button1 = new MyButton("run");
		button1.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e) {
				Driver.infoFrame.grid = null;
				Driver.infoFrame.grid = new JLabel[10][10];
				for(int i = 0; i < 10; i++){
					for(int j = 0; j < 10; j++)
					{
						Driver.infoFrame.grid[i][j] = new JLabel();
					}
				}
				String userCode = Driver.infoFrame.console.getText();
				ScriptEngineManager factory = new ScriptEngineManager();
				ScriptEngine engine = factory.getEngineByName("JavaScript");
				engine.put("Sprite", new Sprite());
				engine.put("Window", Driver.infoFrame);
				try {
					engine.eval(userCode);
				} catch (ScriptException e1) {
					e1.printStackTrace();
				}
				System.out.println(Driver.infoFrame.gridPanel);
				Driver.infoFrame.gridPanel = null;
				Driver.infoFrame.gridPanel = new JPanel(new GridLayout(10,10));
				Color gridColor = new Color(8,229,202);
				int screenWidth = java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment().getMaximumWindowBounds().width;
				int screenHeight = java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment().getMaximumWindowBounds().height;
				Driver.infoFrame.gridPanel.setBackground(gridColor);
				Driver.infoFrame.gridPanel.setPreferredSize(new Dimension((int)(screenWidth * 0.4), (int)(screenHeight * 0.7)));
				Driver.infoFrame.gridPanel.setBorder(BorderFactory.createEmptyBorder(2,2,2,2));
				Driver.infoFrame.gridPanel.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 6, false));
				for(int i = 0; i < 10; i++){
					for(int j = 0; j< 10; j++){
						Driver.infoFrame.grid[i][j].setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY));
						Driver.infoFrame.grid[i][j].revalidate();
						Driver.infoFrame.grid[i][j].repaint();
						Driver.infoFrame.gridPanel.add(Driver.infoFrame.grid[i][j]);
					}
				}
				Driver.infoFrame.gridPanel.revalidate();
				Driver.infoFrame.gridPanel.repaint();
				Driver.infoFrame.right.revalidate();
				Driver.infoFrame.right.repaint();
			}
		});
		add(button1);
	
		
		MyButton button3 = new MyButton("save");
		button3.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e) {
				String file = JOptionPane.showInputDialog(null, "Please enter your file name", "Name Your File", JOptionPane.PLAIN_MESSAGE);
				//File save = new File(file + ".txt");
				PrintWriter out = null;
				try {
					out = new PrintWriter(file + ".txt");
				} catch (FileNotFoundException e1) {
					e1.printStackTrace();
				}
				out.println(InfoFrame.console.getText());
			}
		});
		add(button3);
		
		MyButton button2 = new MyButton("close");
		button2.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e) {
				JOptionPane.showMessageDialog(null, "Thanks for Learning!", "Goodbye", JOptionPane.CLOSED_OPTION);
				System.exit(0);
			}
		});
		add(button2);
		
	}
	
}
class MyButton extends JButton
	{
		public MyButton(String name)
		{
			super(name);
			setForeground(Color.WHITE);
			setBackground(new Color(255,84,9));
			setBorder(BorderFactory.createEmptyBorder());
		}
	}